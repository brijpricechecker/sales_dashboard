<!DOCTYPE html>
<html>
<head>
<title>Sales Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
font-family: Arial, sans-serif;
padding: 10px;
}
.summary {
display: flex;
flex-wrap: wrap;
gap: 15px;
margin-bottom: 20px;
}
.summary-box {
flex: 1;
min-width: 150px;
background: #f0f0f0;
padding: 10px;
border-radius: 5px;
text-align: center;
}
.summary-box.sales { background-color: #d1f2eb; }
.summary-box.purchases { background-color: #fdebd0; }
.summary-box.revenue { background-color: #e8daef; }
canvas {
max-width: 100%;
height: auto;
}
.table-container {
overflow-x: auto;
margin-top: 20px;
}
table {
border-collapse: collapse;
width: 100%;
margin-bottom: 20px;
}
th, td {
border: 1px solid #ccc;
padding: 6px;
text-align: left;
}
th {
background: #f5f5f5;
}
@media (max-width: 768px) {
.summary {
flex-direction: column;
}
}
</style>
</head>
<body>

<h2>Sales Dashboard</h2>

<div class="summary">
<div class="summary-box sales">
<strong>Total Sales</strong>
<div id="totalSales">-</div>
</div>
<div class="summary-box purchases">
<strong>Total Purchases</strong>
<div id="totalPurchases">-</div>
</div>
<div class="summary-box revenue">
<strong>Total Revenue</strong>
<div id="totalRevenue">-</div>
</div>
</div>

<canvas id="lineChart"></canvas>

<div class="table-container">
<h3>Top 10 Items by Quantity Sold</h3>
<table>
<thead>
<tr><th>Item</th><th>Quantity</th><th>Sales</th></tr>
</thead>
<tbody id="topQuantityTable"></tbody>
</table>

<h3>Top 10 Items by Revenue</h3>
<table>
<thead>
<tr><th>Item</th><th>Revenue</th><th>Quantity</th></tr>
</thead>
<tbody id="topRevenueTable"></tbody>
</table>

<h3>Revenue by Supplier</h3>
<table>
<thead>
<tr><th>Supplier</th><th>Revenue</th><th>Sales</th><th>Purchases</th></tr>
</thead>
<tbody id="supplierTable"></tbody>
</table>
</div>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbwA2KDBI3mwXx8mn6n5ICO5tVAexOCRxHGr2IwXnWwvifmHY6-lhX4wB-6NDsQ_ppg/exec'; // Replace with your deployed Web App URL

function formatNumber(num) {
return Number(num).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

async function fetchData() {
const response = await fetch(`${API_URL}?action=getDashboardData`);
const data = await response.json();
updateDashboard(data);
}

function updateDashboard(data) {
document.getElementById("totalSales").textContent = formatNumber(data.totalSales || 0);
document.getElementById("totalPurchases").textContent = formatNumber(data.totalPurchases || 0);
document.getElementById("totalRevenue").textContent = formatNumber(data.totalRevenue || 0);

// Line Chart
const ctx = document.getElementById('lineChart').getContext('2d');
const labels = data.salesLineData.map(d => d.date);
const salesData = data.salesLineData.map(d => d.sales);
const revenueData = data.salesLineData.map(d => d.revenue);

new Chart(ctx, {
type: 'line',
data: {
labels,
datasets: [
{
label: 'Sales',
data: salesData,
borderColor: 'blue',
fill: false,
},
{
label: 'Revenue',
data: revenueData,
borderColor: 'green',
fill: false,
}
]
},
options: {
responsive: true,
maintainAspectRatio: false,
scales: {
x: { title: { display: true, text: 'Date' } },
y: { title: { display: true, text: 'Amount' } }
}
}
});

// Tables
const qtyRows = data.top10Quantity.map(item =>
`<tr><td>${item.item}</td><td>${item.quantity}</td><td>${formatNumber(item.sales)}</td></tr>`
).join('');
document.getElementById("topQuantityTable").innerHTML = qtyRows;

const revRows = data.top10Revenue.map(item =>
`<tr><td>${item.item}</td><td>${formatNumber(item.revenue)}</td><td>${item.quantity}</td></tr>`
).join('');
document.getElementById("topRevenueTable").innerHTML = revRows;

const supRows = data.supplierTable.map(s =>
`<tr><td>${s.supplier}</td><td>${formatNumber(s.revenue)}</td><td>${formatNumber(s.sales)}</td><td>${formatNumber(s.purchases)}</td></tr>`
).join('');
document.getElementById("supplierTable").innerHTML = supRows;
}

fetchData();
</script>

</body>
</html>






<!DOCTYPE html>
<html>
<head>
<title>Sales Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
font-family: Arial, sans-serif;
margin: 0;
padding: 0;
}

.container {
max-width: 1200px;
margin: auto;
padding: 10px;
}

h2 {
text-align: center;
}

.summary-boxes {
display: flex;
flex-wrap: wrap;
justify-content: space-around;
margin-bottom: 20px;
}

.box {
flex: 1 1 30%;
background-color: #f4f4f4;
margin: 10px;
padding: 20px;
text-align: center;
font-size: 1.2em;
border-radius: 8px;
}

.box.sales {
background-color: #c6f6d5;
}

.box.purchases {
background-color: #bee3f8;
}

.box.revenue {
background-color: #fed7e2;
}

.filters {
display: flex;
flex-wrap: wrap;
justify-content: center;
gap: 10px;
margin-bottom: 20px;
}

.filters input,
.filters select {
padding: 5px;
font-size: 1em;
}

canvas {
width: 100% !important;
max-width: 100%;
height: auto !important;
}

.charts-container {
display: flex;
flex-wrap: wrap;
gap: 20px;
justify-content: center;
}

.chart-box {
flex: 1 1 500px;
}

table {
width: 100%;
border-collapse: collapse;
margin: 20px 0;
}

table, th, td {
border: 1px solid #ccc;
}

th, td {
padding: 10px;
text-align: left;
}

@media (max-width: 768px) {
.summary-boxes, .charts-container {
flex-direction: column;
align-items: center;
}

.chart-box {
width: 100%;
}
}
</style>
</head>
<body>
<div class="container">
<h2>Sales Dashboard</h2>

<div class="filters">
<label>Start Date: <input type="date" id="startDate"></label>
<label>End Date: <input type="date" id="endDate"></label>
<label>Supplier:
<select id="supplierSelect">
<option value="">All</option>
</select>
</label>
<button onclick="loadData()">Apply Filters</button>
</div>

<div class="summary-boxes">
<div class="box sales" id="totalSales">Total Sales: 0</div>
<div class="box purchases" id="totalPurchases">Total Purchases: 0</div>
<div class="box revenue" id="totalRevenue">Total Revenue: 0</div>
</div>

<div class="charts-container">
<div class="chart-box">
<canvas id="salesRevenueLineChart"></canvas>
</div>
</div>

<h3>Revenue by Supplier</h3>
<div id="supplierRevenueTableContainer"></div>

<h3>Top 10 Items by Quantity Sold</h3>
<div id="top10SalesTableContainer"></div>

<h3>Top 10 Items by Revenue</h3>
<div id="top10RevenueTableContainer"></div>
</div>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbwA2KDBI3mwXx8mn6n5ICO5tVAexOCRxHGr2IwXnWwvifmHY6-lhX4wB-6NDsQ_ppg/exec';

let salesRevenueChart;

async function loadData() {
const startDate = document.getElementById('startDate').value;
const endDate = document.getElementById('endDate').value;
const supplier = document.getElementById('supplierSelect').value;

const url = `${API_URL}?startDate=${startDate}&endDate=${endDate}&supplier=${encodeURIComponent(supplier)}`;

const response = await fetch(url);
const data = await response.json();

document.getElementById('totalSales').innerText = 'Total Sales: ' + formatNumber(data.totalSales);
document.getElementById('totalPurchases').innerText = 'Total Purchases: ' + formatNumber(data.totalPurchases);
document.getElementById('totalRevenue').innerText = 'Total Revenue: ' + formatNumber(data.totalRevenue);

renderSalesRevenueChart(data.salesRevenueData);
renderTable(data.supplierRevenueTable, 'supplierRevenueTableContainer');
renderTable(data.top10SalesTable, 'top10SalesTableContainer');
renderTable(data.top10RevenueTable, 'top10RevenueTableContainer');

updateSupplierOptions(data.suppliers);
}

function formatNumber(num) {
return parseFloat(num || 0).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function renderSalesRevenueChart(data) {
const ctx = document.getElementById('salesRevenueLineChart').getContext('2d');
if (salesRevenueChart) salesRevenueChart.destroy();

const labels = data.map(d => d.date);
const sales = data.map(d => d.sales);
const revenue = data.map(d => d.revenue);

salesRevenueChart = new Chart(ctx, {
type: 'line',
data: {
labels,
datasets: [
{
label: 'Sales',
data: sales,
borderColor: 'blue',
fill: false
},
{
label: 'Revenue',
data: revenue,
borderColor: 'green',
fill: false
}
]
},
options: {
responsive: true,
scales: {
x: {
ticks: {
callback: value => {
const label = labels[value];
return label ? label.split('/').slice(0, 2).join('/') : '';
}
}
}
}
}
});
}

function renderTable(data, containerId) {
const container = document.getElementById(containerId);
if (!data || data.length === 0) {
container.innerHTML = '<p>No data available.</p>';
return;
}

let table = '<table><thead><tr>';
Object.keys(data[0]).forEach(key => {
table += `<th>${key}</th>`;
});
table += '</tr></thead><tbody>';

data.forEach(row => {
table += '<tr>';
Object.values(row).forEach(value => {
table += `<td>${typeof value === 'number' ? formatNumber(value) : value}</td>`;
});
table += '</tr>';
});

table += '</tbody></table>';
container.innerHTML = table;
}

function updateSupplierOptions(suppliers) {
const select = document.getElementById('supplierSelect');
select.innerHTML = '<option value="">All</option>';
suppliers.forEach(supplier => {
const option = document.createElement('option');
option.value = supplier;
option.textContent = supplier;
select.appendChild(option);
});
}

window.onload = loadData;
</script>
</body>
</html>







<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sales Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
font-family: Arial, sans-serif;
padding: 10px;
margin: 0;
background: #f9f9f9;
}

.header {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-bottom: 20px;
}

.header label {
font-weight: bold;
}

.summary {
display: flex;
flex-wrap: wrap;
gap: 10px;
margin-bottom: 20px;
}

.summary-box {
flex: 1;
min-width: 150px;
background: #ffffff;
border-radius: 8px;
padding: 15px;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.summary-box h3 {
margin: 0;
font-size: 14px;
color: #777;
}

.summary-box p {
margin: 5px 0 0;
font-size: 18px;
font-weight: bold;
}

.sales-box { background-color: #e8f4fd; }
.purchases-box{ background-color: #e8fde8; }
.revenue-box { background-color: #fde8ec; }

.charts {
display: flex;
flex-direction: column;
gap: 30px;
margin-bottom: 30px;
}

.chart-row {
display: flex;
flex-wrap: wrap;
gap: 20px;
justify-content: space-between;
}

.chart-box {
flex: 1;
min-width: 300px;
}

.tables {
display: flex;
flex-wrap: wrap;
gap: 20px;
}

table {
border-collapse: collapse;
width: 100%;
background: white;
margin-top: 10px;
}

th, td {
border: 1px solid #ccc;
padding: 8px;
text-align: left;
}

th {
background-color: #f0f0f0;
}

@media (max-width: 768px) {
.chart-row {
flex-direction: column;
}

.summary {
flex-direction: column;
}
}
</style>
</head>
<body>
<div class="header">
<label>Start Date: <input type="date" id="startDate"></label>
<label>End Date: <input type="date" id="endDate"></label>
<label>Supplier:
<select id="supplierFilter">
<option value="">All</option>
</select>
</label>
<button onclick="loadData()">Apply Filters</button>
</div>

<div class="summary">
<div class="summary-box sales-box">
<h3>Total Sales</h3>
<p id="totalSales">0.00</p>
</div>
<div class="summary-box purchases-box">
<h3>Total Purchases</h3>
<p id="totalPurchases">0.00</p>
</div>
<div class="summary-box revenue-box">
<h3>Total Revenue</h3>
<p id="totalRevenue">0.00</p>
</div>
</div>

<div class="charts">
<div class="chart-row">
<div class="chart-box"><canvas id="salesChart"></canvas></div>
<div class="chart-box"><canvas id="purchasesChart"></canvas></div>
</div>
<div class="chart-row">
<div class="chart-box"><canvas id="revenueChart"></canvas></div>
<div class="chart-box"><canvas id="pieChart"></canvas></div>
</div>
</div>

<div class="tables">
<div class="table-box" style="flex: 1;">
<h3>Top 10 Products by Sales Quantity</h3>
<table id="topSalesTable">
<thead>
<tr><th>Item</th><th>Quantity</th></tr>
</thead>
<tbody></tbody>
</table>
</div>
<div class="table-box" style="flex: 1;">
<h3>Top 10 Products by Revenue</h3>
<table id="topRevenueTable">
<thead>
<tr><th>Item</th><th>Revenue</th><th>Quantity</th></tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>

<script>
let salesChart, purchasesChart, revenueChart, pieChart;

function loadData() {
const startDate = document.getElementById("startDate").value;
const endDate = document.getElementById("endDate").value;
const supplier = document.getElementById("supplierFilter").value;

let url = `https://script.google.com/macros/s/AKfycbyNhFl8nWDfs7LQLWhhbV9-KUdENX-9aqT8W_jr4-zNEjBqeIKXwU9hWRuoTXaiHmJ8/exec`;

fetch(url)
.then(res => res.json())
.then(data => {
document.getElementById("totalSales").textContent = data.totals.sales;
document.getElementById("totalPurchases").textContent = data.totals.purchases;
document.getElementById("totalRevenue").textContent = data.totals.revenue;

// Charts
const labels = Object.keys(data.timeline).sort();
const salesData = labels.map(date => data.timeline[date].sales || 0);
const purchasesData = labels.map(date => data.timeline[date



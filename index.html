<!DOCTYPE html>
<html>
<head>
<base target="_top" />
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<style>
body {
font-family: Arial, sans-serif;
margin: 20px;
padding: 0;
}

.summary-container {
display: flex;
flex-wrap: wrap;
gap: 20px;
margin-bottom: 30px;
}

.summary-box {
flex: 1 1 200px;
padding: 15px;
background-color: #f2f2f2;
border-left: 6px solid #2196f3;
border-radius: 5px;
font-size: 16px;
}

.summary-box.sales { border-left-color: #4CAF50; }
.summary-box.revenue { border-left-color: #FF9800; }
.summary-box.purchases { border-left-color: #f44336; }

.chart-container {
width: 100%;
overflow-x: auto;
margin-bottom: 40px;
}

.table-section {
margin-bottom: 40px;
}

table {
width: 100%;
border-collapse: collapse;
margin-top: 10px;
}

th, td {
border: 1px solid #ddd;
padding: 8px;
text-align: left;
}

th {
background-color: #f2f2f2;
}

@media (max-width: 768px) {
.summary-container {
flex-direction: column;
}
}
</style>
</head>
<body>
<h2>Sales Dashboard</h2>

<div class="summary-container">
<div class="summary-box sales" id="totalSales"></div>
<div class="summary-box revenue" id="totalRevenue"></div>
<div class="summary-box purchases" id="totalPurchases"></div>
</div>

<div class="chart-container">
<div id="lineChart" style="width:100%; max-width:100%; height:400px;"></div>
</div>

<div class="table-section">
<h3>Top 10 Items by Quantity Sold</h3>
<table id="topSalesTable">
<thead>
<tr>
<th>Item</th>
<th>Quantity</th>
<th>Sales</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="table-section">
<h3>Top 10 Items by Revenue</h3>
<table id="topRevenueTable">
<thead>
<tr>
<th>Item</th>
<th>Quantity</th>
<th>Revenue</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="table-section">
<h3>Revenue by Supplier</h3>
<table id="supplierTable">
<thead>
<tr>
<th>Supplier</th>
<th>Revenue</th>
<th>Total Sales</th>
<th>Total Purchases</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
google.charts.load("current", { packages: ["corechart"] });
google.charts.setOnLoadCallback(loadData);

function formatNumber(n) {
return Number(n).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function loadData() {
google.script.run.withSuccessHandler(renderDashboard).getDataWithHeaders();
}

function renderDashboard(data) {
// Summary boxes
document.getElementById("totalSales").textContent = `Total Sales: ${formatNumber(data.summary.totalSales)}`;
document.getElementById("totalRevenue").textContent = `Total Revenue: ${formatNumber(data.summary.totalRevenue)}`;
document.getElementById("totalPurchases").textContent = `Total Purchases: ${formatNumber(data.summary.totalPurchases)}`;

// Line chart
const chartData = [["Date", "Sales", "Revenue"]];
data.salesRevenueChart.forEach(row => {
chartData.push([row.date, row.sales, row.revenue]);
});

const dataTable = google.visualization.arrayToDataTable(chartData);
const options = {
title: "Sales & Revenue Over Time",
curveType: "function",
legend: { position: "bottom" },
height: 400,
};

const chart = new google.visualization.LineChart(document.getElementById("lineChart"));
chart.draw(dataTable, options);

// Top sales table
const topSalesBody = document.querySelector("#topSalesTable tbody");
topSalesBody.innerHTML = "";
data.topSales.forEach(row => {
const tr = document.createElement("tr");
tr.innerHTML = `
<td>${row.item}</td>
<td>${formatNumber(row.quantity)}</td>
<td>${formatNumber(row.sales)}</td>
`;
topSalesBody.appendChild(tr);
});

// Top revenue table
const topRevenueBody = document.querySelector("#topRevenueTable tbody");
topRevenueBody.innerHTML = "";
data.topRevenue.forEach(row => {
const tr = document.createElement("tr");
tr.innerHTML = `
<td>${row.item}</td>
<td>${formatNumber(row.quantity)}</td>
<td>${formatNumber(row.revenue)}</td>
`;
topRevenueBody.appendChild(tr);
});

// Supplier table
const supplierBody = document.querySelector("#supplierTable tbody");
supplierBody.innerHTML = "";
data.supplierTable.forEach(row => {
const tr = document.createElement("tr");
tr.innerHTML = `
<td>${row.supplier}</td>
<td>${formatNumber(row.revenue)}</td>
<td>${formatNumber(row.totalSales)}</td>
<td>${formatNumber(row.totalPurchases)}</td>
`;
supplierBody.appendChild(tr);
});
}
</script>
</body>
</html>




